
const base = 'http://localhost:4000';



function handleErrors(response) {
    if (!response.ok) throw new Error(response.status);
    return response;
}

function send({ method, path, data }) {
	const fetch = process.browser ? window.fetch : require('node-fetch').default;

	const opts = { async: true, method, headers: {} };


	if (data) {
		opts.headers['Content-Type'] = 'application/json';
		opts.body = JSON.stringify(data);
	}

	return fetch(`${base}/${path}`, opts)
		.then(r => r.text()).catch(err => console.log(err) )
		.then(json => {
			try {
				if (json) {
			
				  let parsed = JSON.parse(json);
				  return parsed;
				} else {
				
					console.log('NOT JSON:'+json);
					console.log(base, path);
					console.log(opts);
						console.log(r);
					return r;
					//throw 'Problem getting response in appropiate format. Please contact technical support.'
				}
			} catch (err) {
				throw err;
			}
		}).catch(err => {console.log(err); return err;} );
}

function get(path) {
	return send({ method: 'GET', path });
}

function del(path) {
	return send({ method: 'DELETE', path });
}

function post(path, data) {
	return send({ method: 'POST', path, data });
}

function put(path, data) {
	return send({ method: 'PUT', path, data });
}

function patch(path, data) {
	return send({ method: 'PATCH', path, data });
}

export { get , del , post, put , patch }

// export ftp_password;
